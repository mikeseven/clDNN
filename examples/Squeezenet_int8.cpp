/*
// Copyright (c) 2016 Intel Corporation
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//      http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
*/

#include "common/common_tools.h"
#include "file.h"
#include <string>
#include <api/CPP/input_layout.hpp>
#include <api/CPP/reorder.hpp>
#include <api/CPP/convolution.hpp>
#include <api/CPP/pooling.hpp>
#include <api/CPP/concatenation.hpp>
#include <api/CPP/softmax.hpp>

using namespace cldnn;


template<typename T>
void set_values(const cldnn::memory& mem,const std::vector<T>& args) {
    auto ptr = mem.pointer<T>();

    auto it = ptr.begin();
    for (auto x : args)
        *it++ = x;
}

const std::vector<float> fire8_expand1x1_calib = {
    3.050714f,  2.022486f,  2.527102f,  2.522945f,  1.0938f,  1.189762f,  0.563553f,  1.390082f,  1.597754f,  2.467744f,  2.349289f,  1.094035f,  1.467789f,  4.508902f,  0.950314f,  1.781951f,  3.938424f,  2.557025f,  2.900967f,  2.304632f,  1.76166f,  1.931039f,  1.526864f,  20.994824f,  3.767529f,  6.292767f,  2.109508f,  1.403101f,  6.054856f,  0.926662f,  1.682663f,  6.544368f,  5.593186f,  2.906371f,  10.840802f,  1.532525f,  2.255608f,  2.864224f,  1.050742f,  1.089839f,  1.757542f,  3.362412f,  3.712115f,  7.037883f,  0.844409f,  1.493963f,  1.462162f,  1.139228f,  1.469244f,  2.901696f,  1.891604f,  2.096287f,  5.747881f,  2.201509f,  4.488521f,  2.321636f,  1.822756f,  1.253603f,  2.924219f,  2.01309f,  0.560464f,  1.957725f,  1.259571f,  3.092869f,  1.423634f,  2.474163f,  2.271739f,  2.492229f,  2.829913f,  5.843137f,  2.070886f,  1.177147f,  0.953747f,  1.327809f,  4.022437f,  1.656692f,  1.036329f,  0.925575f,  2.775677f,  0.768695f,  1.842941f,  2.600631f,  0.979772f,  2.133056f,  7.92057f,  1.904239f,  3.784786f,  1.456828f,  1.506167f,  1.054555f,  1.320623f,  1.367718f,  2.398734f,  1.446026f,  2.328135f,  1.986759f,  0.82564f,  1.584114f,  2.498402f,  2.037444f,  1.836024f,  5.378849f,  2.094051f,  1.300048f,  1.667638f,  1.780839f,  5.645122f,  2.375257f,  1.773909f,  8.842349f,  6.347651f,  2.763044f,  1.310975f,  2.685915f,  3.770851f,  1.983253f,  1.48138f,  1.527186f,  1.372888f,  0.883601f,  3.075403f,  2.333444f,  16.684994f,  5.064341f,  1.298012f,  0.779208f,  5.338512f,  2.24848f,  4.899824f,  2.752815f,  1.830573f,  1.028332f,  1.371376f,  2.164074f,  2.253175f,  1.141511f,  1.392906f,  60.612713f,  2.195891f,  2.298659f,  1.681992f,  7.675989f,  5.147744f,  4.039273f,  1.379595f,  2.617693f,  1.659083f,  5.419198f,  3.061259f,  1.670468f,  0.957472f,  1.984915f,  1.647857f,  1.400236f,  1.509904f,  1.111597f,  2.030577f,  1.533807f,  2.429966f,  3.693772f,  1.258186f,  1.967181f,  3.894248f,  1.532012f,  1.84235f,  3.083894f,  1.662197f,  1.888338f,  0.902348f,  4.503578f,  1.395856f,  1.315844f,  1.397712f,  1.211948f,  1.471812f,  1.278395f,  2.444442f,  0.941815f,  1.546651f,  2.524314f,  0.990053f,  1.86407f,  1.497262f,  1.706409f,  1.737608f,  2.392137f,  156.161237f,  2.702283f,  1.277724f,  1.281169f,  2.408793f,  1.462562f,  1.667141f,  2.272508f,  6.413947f,  1.707228f,  5.503673f,  1.674f,  1.806723f,  1.468898f,  1.044236f,  11.751425f,  1.788068f,  3.757296f,  2.436745f,  4.593211f,  1.712546f,  1.897216f,  1.780023f,  2.284826f,  0.980953f,  1.795558f,  2.714963f,  1.50088f,  1.778408f,  12.768426f,  6.377519f,  2.160768f,  2.458115f,  2.545871f,  2.335671f,  1.789753f,  4.839386f,  0.956275f,  1.880289f,  4.364471f,  3.208262f,  5.099071f,  0.989035f,  1.956757f,  1.931885f,  2.191926f,  3.620214f,  1.320875f,  1.500948f,  1.000843f,  1.911114f,  2.620799f,  1.776423f,  2.149198f,  1.113361f,  1.026686f,  3.28123f,  4.103446f,  0.757675f,  0.699802f,  2.975709f,  2.523456f,  2.718607f,  1.481443f,  1.375878f,  3.430328f,  2.106534f,  4.796344f,  2.674315f,  1.09144f, };
const std::vector<float> fire8_concat_calib = {
    3.050714f,  2.022486f,  2.527102f,  2.522945f,  1.0938f,  1.189762f,  0.563553f,  1.390082f,  1.597754f,  2.467744f,  2.349289f,  1.094035f,  1.467789f,  4.508902f,  0.950314f,  1.781951f,  3.938424f,  2.557025f,  2.900967f,  2.304632f,  1.76166f,  1.931039f,  1.526864f,  20.994824f,  3.767529f,  6.292767f,  2.109508f,  1.403101f,  6.054856f,  0.926662f,  1.682663f,  6.544368f,  5.593186f,  2.906371f,  10.840802f,  1.532525f,  2.255608f,  2.864224f,  1.050742f,  1.089839f,  1.757542f,  3.362412f,  3.712115f,  7.037883f,  0.844409f,  1.493963f,  1.462162f,  1.139228f,  1.469244f,  2.901696f,  1.891604f,  2.096287f,  5.747881f,  2.201509f,  4.488521f,  2.321636f,  1.822756f,  1.253603f,  2.924219f,  2.01309f,  0.560464f,  1.957725f,  1.259571f,  3.092869f,  1.423634f,  2.474163f,  2.271739f,  2.492229f,  2.829913f,  5.843137f,  2.070886f,  1.177147f,  0.953747f,  1.327809f,  4.022437f,  1.656692f,  1.036329f,  0.925575f,  2.775677f,  0.768695f,  1.842941f,  2.600631f,  0.979772f,  2.133056f,  7.92057f,  1.904239f,  3.784786f,  1.456828f,  1.506167f,  1.054555f,  1.320623f,  1.367718f,  2.398734f,  1.446026f,  2.328135f,  1.986759f,  0.82564f,  1.584114f,  2.498402f,  2.037444f,  1.836024f,  5.378849f,  2.094051f,  1.300048f,  1.667638f,  1.780839f,  5.645122f,  2.375257f,  1.773909f,  8.842349f,  6.347651f,  2.763044f,  1.310975f,  2.685915f,  3.770851f,  1.983253f,  1.48138f,  1.527186f,  1.372888f,  0.883601f,  3.075403f,  2.333444f,  16.684994f,  5.064341f,  1.298012f,  0.779208f,  5.338512f,  2.24848f,  4.899824f,  2.752815f,  1.830573f,  1.028332f,  1.371376f,  2.164074f,  2.253175f,  1.141511f,  1.392906f,  60.612713f,  2.195891f,  2.298659f,  1.681992f,  7.675989f,  5.147744f,  4.039273f,  1.379595f,  2.617693f,  1.659083f,  5.419198f,  3.061259f,  1.670468f,  0.957472f,  1.984915f,  1.647857f,  1.400236f,  1.509904f,  1.111597f,  2.030577f,  1.533807f,  2.429966f,  3.693772f,  1.258186f,  1.967181f,  3.894248f,  1.532012f,  1.84235f,  3.083894f,  1.662197f,  1.888338f,  0.902348f,  4.503578f,  1.395856f,  1.315844f,  1.397712f,  1.211948f,  1.471812f,  1.278395f,  2.444442f,  0.941815f,  1.546651f,  2.524314f,  0.990053f,  1.86407f,  1.497262f,  1.706409f,  1.737608f,  2.392137f,  156.161237f,  2.702283f,  1.277724f,  1.281169f,  2.408793f,  1.462562f,  1.667141f,  2.272508f,  6.413947f,  1.707228f,  5.503673f,  1.674f,  1.806723f,  1.468898f,  1.044236f,  11.751425f,  1.788068f,  3.757296f,  2.436745f,  4.593211f,  1.712546f,  1.897216f,  1.780023f,  2.284826f,  0.980953f,  1.795558f,  2.714963f,  1.50088f,  1.778408f,  12.768426f,  6.377519f,  2.160768f,  2.458115f,  2.545871f,  2.335671f,  1.789753f,  4.839386f,  0.956275f,  1.880289f,  4.364471f,  3.208262f,  5.099071f,  0.989035f,  1.956757f,  1.931885f,  2.191926f,  3.620214f,  1.320875f,  1.500948f,  1.000843f,  1.911114f,  2.620799f,  1.776423f,  2.149198f,  1.113361f,  1.026686f,  3.28123f,  4.103446f,  0.757675f,  0.699802f,  2.975709f,  2.523456f,  2.718607f,  1.481443f,  1.375878f,  3.430328f,  2.106534f,  4.796344f,  2.674315f,  1.09144f,  1.18055f,  0.357571f,  1.397313f,  0.796858f,  0.389696f,  1.534054f,  1.498474f,  0.877478f,  0.501156f,  0.388663f,  1.183608f,  0.568828f,  0.373075f,  0.842801f,  0.400638f,  0.638875f,  1.725063f,  0.865017f,  0.674441f,  1.442164f,  0.877284f,  0.966463f,  1.219864f,  1.478877f,  0.496736f,  0.397159f,  1.486194f,  0.759678f,  0.807297f,  0.388429f,  0.899625f,  0.749696f,  0.29402f,  0.751862f,  0.819524f,  0.874391f,  0.512467f,  0.62967f,  0.881957f,  0.951731f,  0.904552f,  0.442111f,  1.565783f,  2.274115f,  1.554734f,  0.555886f,  0.682176f,  0.528852f,  0.773593f,  0.842376f,  0.528849f,  0.917995f,  1.59043f,  0.68727f,  3.876868f,  1.326785f,  0.410569f,  2.124183f,  0.724902f,  1.297861f,  1.895913f,  1.096321f,  0.500572f,  1.064231f,  0.331106f,  0.467611f,  1.173503f,  0.963837f,  0.559871f,  0.503441f,  0.680013f,  0.756497f,  0.0f,  0.823723f,  1.357593f,  1.298007f,  1.688659f,  1.428547f,  0.7341f,  1.883351f,  0.644578f,  0.834253f,  0.415413f,  0.939857f,  0.308105f,  1.749316f,  0.539831f,  0.851869f,  0.387038f,  0.418212f,  1.481367f,  1.445496f,  0.91142f,  1.32337f,  1.419196f,  0.529665f,  1.22684f,  0.431321f,  0.283433f,  0.704182f,  1.657626f,  1.762635f,  0.809056f,  2.062884f,  0.800504f,  1.09854f,  0.821943f,  1.198294f,  1.095838f,  0.540124f,  0.330461f,  0.459614f,  0.877714f,  0.984092f,  0.633979f,  1.405296f,  0.981483f,  0.432365f,  1.051943f,  0.512999f,  0.43167f,  0.446466f,  0.503126f,  0.791139f,  1.120206f,  1.533472f,  1.087906f,  1.191314f,  0.984313f,  0.85439f,  1.587419f,  1.40555f,  0.855709f,  2.253691f,  0.730288f,  0.808799f,  0.901393f,  1.309829f,  1.209639f,  0.651777f,  0.46802f,  1.697704f,  0.302667f,  0.885598f,  0.805909f,  0.542888f,  0.758177f,  0.464975f,  1.040037f,  0.729277f,  1.05544f,  0.555813f,  2.162059f,  0.761154f,  1.159891f,  0.343309f,  0.545425f,  1.268731f,  19.495661f,  1.253875f,  0.429221f,  1.119821f,  0.413332f,  1.698667f,  1.272683f,  0.856545f,  0.791258f,  0.889306f,  0.854758f,  0.510996f,  0.890503f,  1.146209f,  0.901029f,  4.065652f,  4.150842f,  1.128799f,  0.517032f,  0.272174f,  0.692959f,  1.08509f,  0.799371f,  0.934862f,  0.852589f,  0.812722f,  0.390597f,  1.35552f,  0.826839f,  0.644686f,  1.049752f,  0.415705f,  1.311817f,  0.684112f,  0.460858f,  4.223352f,  1.114446f,  0.485422f,  0.637454f,  1.115767f,  0.563283f,  0.53404f,  0.702822f,  0.859578f,  0.652319f,  1.335825f,  0.717879f,  1.075697f,  0.844123f,  0.368189f,  0.360682f,  0.39049f,  1.779482f,  0.602513f,  0.656531f,  0.706832f,  3.508908f,  1.436947f,  6.227871f,  0.502938f,  1.29575f,  0.89773f,  3.741137f,  0.605188f,  0.0f,  1.60514f,  1.646827f,  1.280383f,  0.600751f,  0.764328f,  0.452592f,  1.246467f,  1.231408f,  2.66628f,  0.58383f,  0.559826f,  0.61276f,  0.193079f,  1.491671f,  0.696127f,  0.947422f,  4.385768f,  1.844464f,  1.384112f,  0.588451f,  0.396164f,  0.463952f,  0.881816f,  1.021106f,  0.741831f,  1.10479f,  0.56587f,  1.012888f,  3.161075f,  0.259832f,  1.014231f,  0.794649f,  0.604915f, };
const std::vector<float> fire9_squeeze1x1_calib = {
    0.439836f,  0.603474f,  0.195156f,  0.631533f,  0.45192f,  0.549772f,  0.408287f,  0.581326f,  1.051124f,  0.713607f,  0.970518f,  0.392123f,  0.454462f,  0.570758f,  0.494213f,  0.916855f,  0.335182f,  0.894807f,  0.244157f,  0.356066f,  0.414969f,  0.776682f,  1.264424f,  0.652001f,  0.679188f,  1.506112f,  0.450556f,  0.485222f,  0.362188f,  0.520592f,  0.91014f,  0.269489f,  0.55197f,  0.451711f,  0.45856f,  0.721669f,  0.454868f,  0.658338f,  0.403278f,  0.620784f,  0.479519f,  0.413085f,  0.739735f,  0.42405f,  0.337528f,  0.387172f,  1.159658f,  1.270457f,  0.558453f,  0.531634f,  0.117552f,  0.436011f,  0.420449f,  0.536134f,  0.59406f,  1.814073f,  0.31887f,  0.535084f,  1.34276f,  0.526211f,  0.339986f,  0.488578f,  0.505932f,  0.357965f, };
const std::vector<float> fire9_concat_calib = {
    0.941047f,  1.247213f,  7.632166f,  0.690649f,  0.0f,  4.1728f,  0.0f,  5.565806f,  11.186766f,  4.192997f,  4.238858f,  0.0f,  3.871361f,  3.401124f,  7.463169f,  3.245061f,  9.667499f,  0.850095f,  4.767464f,  1.940534f,  3.350446f,  10.052479f,  1.183322f,  0.0f,  0.0f,  8.977803f,  6.190773f,  8.924556f,  5.315542f,  6.153608f,  0.0f,  0.645932f,  4.752051f,  2.64352f,  1.841145f,  13.922065f,  0.985573f,  1.601812f,  4.592348f,  6.056589f,  1.536364f,  9.140044f,  1.985377f,  2.193213f,  1.580711f,  0.0f,  0.819841f,  0.0f,  1.989585f,  1.137371f,  0.656534f,  1.993533f,  1.751937f,  26.332268f,  2.31825f,  2.141924f,  1.390842f,  0.816852f,  1.839231f,  1.537988f,  8.023806f,  1.821483f,  6.251631f,  0.0f,  3.206925f,  0.0f,  3.448117f,  2.259827f,  9.469062f,  13.201087f,  0.0f,  4.176381f,  1.089736f,  2.8137f,  22.593362f,  39.005753f,  0.800005f,  4.37236f,  2.115743f,  2.141526f,  1.502676f,  0.0f,  0.0f,  0.0f,  0.727969f,  2.120491f,  1.973781f,  0.0f,  0.0f,  8.507731f,  2.218232f,  1.005845f,  1.177955f,  4.50871f,  0.811362f,  2.168657f,  1.29958f,  2.352854f,  1.124073f,  3.902601f,  0.0f,  2.953646f,  1.990524f,  14.030452f,  10.048661f,  0.81266f,  3.401515f,  2.017359f,  0.745467f,  0.0f,  1.137983f,  9.577316f,  0.0f,  1.704261f,  2.072634f,  1.315367f,  1.270193f,  0.0f,  1.353946f,  0.0f,  2.909268f,  4.298149f,  0.0f,  2.100173f,  1.508613f,  2.162692f,  5.874272f,  1.547427f,  0.750015f,  5.971104f,  0.0f,  0.98455f,  9.635739f,  2.327917f,  2.369478f,  1.362393f,  0.0f,  6.013941f,  1.435479f,  7.599921f,  2.364603f,  2.091416f,  5.812357f,  2.839321f,  3.940281f,  0.0f,  3.543734f,  0.0f,  3.449606f,  2.24889f,  25.617751f,  0.785221f,  5.20622f,  1.318586f,  0.0f,  1.539194f,  1.501388f,  0.89707f,  1.132008f,  78.75969f,  0.886704f,  1.538784f,  5.938353f,  0.0f,  6.311029f,  2.305126f,  0.971356f,  1.577048f,  0.0f,  2.901411f,  4.433367f,  1.407115f,  3.798063f,  10.835345f,  0.781899f,  2.003158f,  1.894612f,  13.395791f,  0.0f,  2.281481f,  6.860007f,  1.575589f,  1.544952f,  2.631355f,  5.834976f,  22.423504f,  2.182416f,  0.0f,  0.0f,  4.25311f,  27.984972f,  5.201401f,  0.842924f,  1.692893f,  2.363622f,  0.0f,  5.884588f,  5.310874f,  1.97884f,  3.583724f,  0.0f,  2.387986f,  2.991452f,  5.28616f,  1.980226f,  6.92721f,  2.986401f,  0.0f,  82.099153f,  8.498394f,  0.0f,  4.935105f,  0.0f,  0.0f,  1.912092f,  3.876998f,  1.592874f,  8.128f,  3.203729f,  4.848753f,  5.378439f,  0.83612f,  1.779005f,  1.898685f,  0.0f,  1.037989f,  0.0f,  3.897547f,  2.458534f,  9.395854f,  63.377681f,  13.727044f,  0.581244f,  4.597002f,  0.982121f,  5.058753f,  0.726852f,  36.505687f,  10.944408f,  1.620851f,  0.594146f,  2.545361f,  0.0f,  9.008626f,  1.144093f,  1.412942f,  11.164933f,  0.0f,  0.0f,  1.107825f,  0.947867f,  0.869053f,  1.256493f,  1.823775f,  0.801115f,  1.46295f,  1.007729f,  2.401496f,  2.210445f,  2.804331f,  0.600268f,  2.477034f,  2.388336f,  5.995232f,  1.543836f,  0.877708f,  0.0f,  8.896174f,  0.0f,  7.731974f,  1.388156f,  2.891964f,  3.589132f,  2.290087f,  0.982144f,  1.13316f,  0.591399f,  1.471249f,  0.973516f,  0.623325f,  6.779046f,  2.12515f,  6.558528f,  2.584479f,  0.0f,  1.307016f,  3.682867f,  3.920721f,  1.991873f,  0.0f,  1.00933f,  10.10535f,  13.11363f,  11.427646f,  2.716967f,  1.203712f,  5.662918f,  0.656575f,  1.026171f,  1.665655f,  0.0f,  1.926096f,  3.823861f,  2.485892f,  13.335013f,  3.328816f,  3.295055f,  1.103446f,  1.706565f,  1.977568f,  1.817664f,  1.269416f,  1.632326f,  13.455157f,  0.703254f,  3.818068f,  6.0099f,  1.716945f,  1.012001f,  1.058536f,  7.705095f,  0.822635f,  0.90737f,  0.0f,  1.844892f,  1.350142f,  5.740891f,  1.289277f,  1.945925f,  2.318288f,  0.580869f,  1.450981f,  1.455714f,  1.379477f,  1.408449f,  1.92198f,  0.451988f,  3.249569f,  7.528871f,  1.322958f,  2.533322f,  0.0f,  1.709031f,  0.922121f,  2.274461f,  0.0f,  5.21f,  0.0f,  1.463555f,  0.928546f,  0.566443f,  0.0f,  1.179519f,  0.637131f,  6.989736f,  1.813508f,  4.079745f,  0.997502f,  0.76973f,  58.69738f,  2.738403f,  2.187487f,  2.27493f,  1.098093f,  0.698766f,  0.770299f,  1.46814f,  1.5039f,  0.842891f,  0.374346f,  4.017017f,  4.586841f,  1.065857f,  0.0f,  1.092765f,  2.966375f,  1.404925f,  5.016055f,  1.194934f,  1.73824f,  8.225762f,  0.349001f,  2.786469f,  1.177551f,  0.952602f,  0.629832f,  2.317937f,  1.661458f,  0.958722f,  1.063937f,  4.762744f,  0.0f,  2.526262f,  1.212341f,  1.03071f,  0.577761f,  2.339379f,  1.492129f,  1.04147f,  3.54161f,  0.463795f,  0.601152f,  1.794231f,  0.4616f,  2.561548f,  84.413426f,  0.44882f,  0.91993f,  6.960315f,  0.936986f,  3.74491f,  0.354527f,  1.277685f,  0.0f,  1.084626f,  0.0f,  0.0f,  0.900863f,  0.988081f,  1.058545f,  0.987497f,  2.625214f,  1.071676f,  1.428207f,  2.7997f,  1.203643f,  8.308419f,  0.778368f,  0.868352f,  2.998288f,  1.608344f,  1.626441f,  0.472854f,  2.759934f,  1.060747f,  3.992819f,  3.849266f,  0.34631f,  2.325173f,  2.74959f,  0.7573f,  2.379543f,  2.119585f,  1.038388f,  0.237891f,  1.609455f,  0.0f,  3.422378f,  6.041951f,  1.431407f,  0.0f,  2.833493f,  10.829247f,  2.086804f,  2.041407f,  3.291878f,  8.709009f,  1.192925f,  0.85192f,  1.329407f,  1.479309f,  0.736454f,  2.36452f,  6.48022f,  2.118503f,  2.700203f,  7.382004f,  2.574728f,  1.316668f,  0.560848f,  2.698167f,  2.50727f,  5.32169f,  1.699319f,  1.247422f,  0.0f,  1.793251f,  2.931827f,  1.108725f,  0.575603f,  0.0f,  1.541442f,  2.896528f,  0.937975f,  4.507494f,  1.247826f,  1.27767f,  0.88818f,  0.850369f,  1.326002f,  0.620141f,  4.779899f,  1.106715f,  15.19575f,  0.756155f,  2.571235f,  2.025867f,  0.0f,  130.233569f,  1.148085f,  1.467351f,  0.715199f,  1.164304f,  4.975807f,  7.995769f,  0.510009f,  1.120572f,  2.292464f,  1.125158f,  1.118746f,  0.83456f,  1.730606f, };
const std::vector<float> fire8_expand3x3_calib = {
    1.18055f,  0.357571f,  1.397313f,  0.796858f,  0.389696f,  1.534054f,  1.498474f,  0.877478f,  0.501156f,  0.388663f,  1.183608f,  0.568828f,  0.373075f,  0.842801f,  0.400638f,  0.638875f,  1.725063f,  0.865017f,  0.674441f,  1.442164f,  0.877284f,  0.966463f,  1.219864f,  1.478877f,  0.496736f,  0.397159f,  1.486194f,  0.759678f,  0.807297f,  0.388429f,  0.899625f,  0.749696f,  0.29402f,  0.751862f,  0.819524f,  0.874391f,  0.512467f,  0.62967f,  0.881957f,  0.951731f,  0.904552f,  0.442111f,  1.565783f,  2.274115f,  1.554734f,  0.555886f,  0.682176f,  0.528852f,  0.773593f,  0.842376f,  0.528849f,  0.917995f,  1.59043f,  0.68727f,  3.876868f,  1.326785f,  0.410569f,  2.124183f,  0.724902f,  1.297861f,  1.895913f,  1.096321f,  0.500572f,  1.064231f,  0.331106f,  0.467611f,  1.173503f,  0.963837f,  0.559871f,  0.503441f,  0.680013f,  0.756497f,  0.0f,  0.823723f,  1.357593f,  1.298007f,  1.688659f,  1.428547f,  0.7341f,  1.883351f,  0.644578f,  0.834253f,  0.415413f,  0.939857f,  0.308105f,  1.749316f,  0.539831f,  0.851869f,  0.387038f,  0.418212f,  1.481367f,  1.445496f,  0.91142f,  1.32337f,  1.419196f,  0.529665f,  1.22684f,  0.431321f,  0.283433f,  0.704182f,  1.657626f,  1.762635f,  0.809056f,  2.062884f,  0.800504f,  1.09854f,  0.821943f,  1.198294f,  1.095838f,  0.540124f,  0.330461f,  0.459614f,  0.877714f,  0.984092f,  0.633979f,  1.405296f,  0.981483f,  0.432365f,  1.051943f,  0.512999f,  0.43167f,  0.446466f,  0.503126f,  0.791139f,  1.120206f,  1.533472f,  1.087906f,  1.191314f,  0.984313f,  0.85439f,  1.587419f,  1.40555f,  0.855709f,  2.253691f,  0.730288f,  0.808799f,  0.901393f,  1.309829f,  1.209639f,  0.651777f,  0.46802f,  1.697704f,  0.302667f,  0.885598f,  0.805909f,  0.542888f,  0.758177f,  0.464975f,  1.040037f,  0.729277f,  1.05544f,  0.555813f,  2.162059f,  0.761154f,  1.159891f,  0.343309f,  0.545425f,  1.268731f,  19.495661f,  1.253875f,  0.429221f,  1.119821f,  0.413332f,  1.698667f,  1.272683f,  0.856545f,  0.791258f,  0.889306f,  0.854758f,  0.510996f,  0.890503f,  1.146209f,  0.901029f,  4.065652f,  4.150842f,  1.128799f,  0.517032f,  0.272174f,  0.692959f,  1.08509f,  0.799371f,  0.934862f,  0.852589f,  0.812722f,  0.390597f,  1.35552f,  0.826839f,  0.644686f,  1.049752f,  0.415705f,  1.311817f,  0.684112f,  0.460858f,  4.223352f,  1.114446f,  0.485422f,  0.637454f,  1.115767f,  0.563283f,  0.53404f,  0.702822f,  0.859578f,  0.652319f,  1.335825f,  0.717879f,  1.075697f,  0.844123f,  0.368189f,  0.360682f,  0.39049f,  1.779482f,  0.602513f,  0.656531f,  0.706832f,  3.508908f,  1.436947f,  6.227871f,  0.502938f,  1.29575f,  0.89773f,  3.741137f,  0.605188f,  0.0f,  1.60514f,  1.646827f,  1.280383f,  0.600751f,  0.764328f,  0.452592f,  1.246467f,  1.231408f,  2.66628f,  0.58383f,  0.559826f,  0.61276f,  0.193079f,  1.491671f,  0.696127f,  0.947422f,  4.385768f,  1.844464f,  1.384112f,  0.588451f,  0.396164f,  0.463952f,  0.881816f,  1.021106f,  0.741831f,  1.10479f,  0.56587f,  1.012888f,  3.161075f,  0.259832f,  1.014231f,  0.794649f,  0.604915f, };
const std::vector<float> conv10_calib = {
    1.721803f,  4.181662f,  2.020359f,  2.758064f,  2.587818f,  2.160125f,  1.644873f,  1.664107f,  1.47966f,  1.271438f,  1.125647f,  2.435091f,  2.423669f,  1.722258f,  2.424381f,  3.639865f,  2.791043f,  2.427509f,  4.019076f,  1.779177f,  1.896391f,  1.339937f,  1.49663f,  1.267339f,  1.188749f,  1.139044f,  2.300762f,  2.412536f,  1.185431f,  2.127196f,  1.399151f,  1.02869f,  1.18993f,  1.625981f,  2.082247f,  1.606743f,  1.678005f,  2.184018f,  1.464666f,  1.516128f,  2.589892f,  2.794255f,  2.146902f,  1.86243f,  3.059202f,  1.845914f,  2.563849f,  1.830013f,  1.631912f,  1.449128f,  1.804721f,  1.711383f,  3.351419f,  3.120569f,  1.805834f,  2.427291f,  2.450952f,  3.236098f,  1.898387f,  1.846693f,  1.727259f,  1.515895f,  2.490875f,  2.204689f,  2.361604f,  2.096592f,  1.969154f,  1.767001f,  1.827254f,  3.406579f,  3.548229f,  2.271975f,  2.940414f,  2.169876f,  2.851446f,  3.210427f,  2.327201f,  2.088699f,  2.608976f,  3.095379f,  1.867647f,  2.908115f,  1.956085f,  2.212474f,  2.023285f,  1.748825f,  1.927551f,  1.371729f,  3.117023f,  2.208419f,  2.842804f,  3.725651f,  5.995996f,  3.454203f,  2.009764f,  3.380519f,  2.653839f,  1.294221f,  2.136188f,  1.746213f,  2.38085f,  1.653829f,  1.021648f,  1.044262f,  1.114974f,  0.74745f,  0.978037f,  3.625847f,  2.991311f,  3.261612f,  1.303262f,  3.572705f,  1.983433f,  2.567674f,  3.771949f,  2.274571f,  2.505751f,  2.158997f,  1.46497f,  2.454732f,  3.108357f,  3.254616f,  2.265394f,  2.348842f,  2.91574f,  2.846621f,  3.860757f,  5.156669f,  3.906454f,  4.580059f,  1.492958f,  2.315241f,  5.213807f,  2.205175f,  1.655305f,  1.859697f,  2.662178f,  2.229423f,  2.574128f,  1.130799f,  1.320922f,  2.082192f,  2.183909f,  3.409286f,  2.933777f,  1.835517f,  1.751792f,  2.384636f,  3.356627f,  1.540307f,  1.358116f,  1.036278f,  2.907057f,  1.896482f,  2.85458f,  2.586395f,  1.988327f,  1.620803f,  0.998522f,  0.908512f,  1.192186f,  0.932281f,  0.816783f,  1.225407f,  1.033352f,  1.332488f,  0.775274f,  0.832776f,  1.082371f,  0.934469f,  1.133372f,  0.769888f,  0.710406f,  1.115043f,  1.030928f,  2.121695f,  0.979153f,  0.997181f,  1.360872f,  1.167494f,  0.893668f,  1.177911f,  1.274922f,  1.46169f,  1.287419f,  1.869767f,  1.082242f,  1.947668f,  1.038379f,  1.172972f,  1.492204f,  1.333221f,  1.452685f,  1.363953f,  1.723382f,  1.937591f,  1.536362f,  1.606141f,  1.261297f,  1.818289f,  2.050163f,  1.782469f,  1.416985f,  1.266934f,  2.603158f,  1.062797f,  0.796758f,  0.792324f,  0.881938f,  0.973247f,  1.251898f,  1.293745f,  1.052867f,  1.227231f,  1.715097f,  1.090784f,  1.558695f,  1.992429f,  1.187593f,  1.272224f,  1.33699f,  1.040063f,  0.929218f,  1.266732f,  1.011477f,  1.100386f,  1.958728f,  1.008457f,  1.807171f,  2.334327f,  1.142703f,  1.077239f,  1.210862f,  1.670635f,  1.46484f,  0.974053f,  1.048287f,  1.320246f,  1.450076f,  1.959018f,  1.078657f,  1.113889f,  1.351748f,  1.364434f,  1.190387f,  1.596165f,  0.995048f,  1.206513f,  1.122533f,  1.034042f,  1.072744f,  0.867202f,  1.66211f,  0.726965f,  1.480109f,  1.286488f,  1.346916f,  1.002542f,  1.405197f,  1.281048f,  0.861233f,  1.465249f,  1.614092f,  0.86972f,  0.909703f,  0.909768f,  0.974951f,  0.93383f,  0.924632f,  0.74637f,  0.800883f,  0.813347f,  0.855882f,  0.650765f,  0.769818f,  1.044322f,  0.792245f,  0.74062f,  0.729583f,  1.105232f,  0.740879f,  1.990786f,  1.544127f,  2.21931f,  1.424017f,  1.519688f,  0.692109f,  1.144588f,  1.177485f,  1.223978f,  0.789541f,  1.0563f,  1.651624f,  0.832334f,  0.864216f,  1.136862f,  0.718574f,  0.845748f,  0.873549f,  0.786612f,  6.265942f,  4.631622f,  2.77358f,  2.855646f,  3.464285f,  2.491696f,  1.906123f,  2.12349f,  3.872884f,  3.182734f,  1.856364f,  1.417694f,  1.966913f,  3.38441f,  3.325922f,  3.043236f,  2.283364f,  2.119974f,  4.145112f,  3.587834f,  2.979276f,  3.028446f,  2.972165f,  3.126062f,  3.009835f,  4.211434f,  1.960924f,  2.580892f,  2.42913f,  2.72243f,  2.218124f,  1.725785f,  2.267594f,  1.31571f,  2.262234f,  1.133655f,  1.150435f,  1.21881f,  2.363846f,  1.601271f,  1.481793f,  1.170895f,  1.077403f,  1.265722f,  1.131292f,  1.26658f,  1.071685f,  1.032999f,  0.827173f,  0.910786f,  1.31346f,  1.436059f,  2.100045f,  1.217711f,  1.088596f,  0.981665f,  1.262162f,  1.645931f,  1.337318f,  1.322166f,  1.123973f,  1.535098f,  1.015691f,  2.389468f,  1.315766f,  0.974651f,  1.420836f,  1.742509f,  1.676271f,  1.960509f,  1.34045f,  1.732469f,  1.176961f,  1.334331f,  1.80182f,  2.278971f,  1.671277f,  1.962354f,  2.185811f,  1.275121f,  1.327666f,  1.261836f,  0.923106f,  1.447002f,  1.80032f,  1.714018f,  1.725565f,  1.066528f,  1.487614f,  1.918319f,  3.094421f,  1.882446f,  2.871679f,  3.018125f,  2.315347f,  2.19332f,  2.454453f,  1.46001f,  1.622298f,  2.738633f,  1.749292f,  1.142847f,  3.497746f,  1.646532f,  3.079773f,  4.162365f,  2.842995f,  2.512419f,  2.847783f,  4.105674f,  2.481836f,  2.400262f,  1.981715f,  2.098154f,  2.400207f,  3.274664f,  1.560952f,  2.090662f,  1.443364f,  1.927847f,  1.805513f,  2.81312f,  2.120629f,  2.066243f,  1.821444f,  3.343293f,  2.82194f,  2.936817f,  1.638006f,  2.006636f,  1.80548f,  1.981248f,  1.2976f,  2.228356f,  1.391758f,  1.840492f,  3.946649f,  2.613825f,  1.588533f,  2.646059f,  2.184788f,  1.494336f,  3.718985f,  2.682386f,  1.622462f,  1.85169f,  1.996256f,  1.428795f,  2.16413f,  3.550531f,  2.263972f,  2.110174f,  1.667275f,  2.548972f,  1.527085f,  3.167785f,  2.240135f,  1.546372f,  2.581395f,  2.504704f,  3.594455f,  2.358583f,  2.659162f,  1.283618f,  2.991367f,  1.750563f,  3.15564f,  1.392136f,  5.110705f,  1.486488f,  2.939822f,  1.606042f,  3.434605f,  2.75982f,  2.558122f,  2.483428f,  1.293926f,  1.718064f,  2.167202f,  3.319793f,  1.607312f,  2.563885f,  3.026642f,  1.870673f,  4.295736f,  4.752265f,  2.132042f,  1.409971f,  2.170643f,  2.602912f,  2.646313f,  2.308201f,  2.387407f,  3.282833f,  2.267509f,  2.034969f,  1.357682f,  4.025433f,  2.419545f,  1.993833f,  3.107361f,  2.366674f,  1.955471f,  3.034481f,  1.663024f,  2.438711f,  3.161996f,  1.1693f,  1.889715f,  2.295771f,  3.70162f,  2.075706f,  2.316884f,  1.764786f,  2.424909f,  1.764296f,  2.524404f,  1.631797f,  1.834786f,  2.037402f,  2.494275f,  1.218635f,  1.23392f,  1.853195f,  1.96253f,  3.341393f,  2.182371f,  2.943371f,  2.622412f,  3.040147f,  2.249053f,  2.328882f,  2.588134f,  2.407679f,  1.858886f,  2.362044f,  3.137747f,  1.094507f,  4.904062f,  1.528029f,  1.831565f,  4.001285f,  2.850794f,  2.212906f,  2.263274f,  4.116507f,  2.061357f,  2.767198f,  1.991929f,  2.721567f,  1.698772f,  2.12663f,  1.356535f,  3.788941f,  4.1938f,  2.072096f,  2.651518f,  2.029224f,  1.31197f,  1.641733f,  2.16235f,  4.908421f,  2.620621f,  1.685613f,  4.032732f,  2.975654f,  1.391878f,  3.187959f,  1.7272f,  2.244256f,  2.099878f,  3.436575f,  2.747597f,  3.452231f,  3.125508f,  2.336058f,  2.155052f,  3.492532f,  2.657843f,  2.578172f,  3.308265f,  4.359183f,  3.652059f,  2.870316f,  2.870991f,  1.58287f,  2.026071f,  1.737579f,  1.767362f,  1.54237f,  1.564828f,  2.506399f,  5.28616f,  1.490358f,  2.577471f,  2.809206f,  1.716789f,  3.290164f,  2.640146f,  3.259829f,  2.129054f,  3.477223f,  1.312415f,  1.827906f,  1.71594f,  2.126014f,  2.741346f,  3.195861f,  3.1608f,  2.639438f,  2.262423f,  2.397036f,  1.738369f,  2.890496f,  3.226315f,  1.428032f,  1.963167f,  3.02893f,  1.596813f,  2.206804f,  3.22031f,  2.7873f,  1.306414f,  2.653623f,  4.587405f,  3.922731f,  1.7335f,  3.779289f,  2.62199f,  1.599881f,  2.483758f,  1.404979f,  2.473353f,  2.385577f,  3.041035f,  3.251258f,  2.061534f,  1.148126f,  2.106954f,  1.611197f,  3.685518f,  2.051272f,  2.485678f,  1.360645f,  2.500418f,  2.149813f,  3.196553f,  2.46073f,  2.123068f,  2.492038f,  1.509213f,  2.177846f,  2.633008f,  1.467918f,  1.726005f,  3.500107f,  2.917756f,  3.575078f,  1.531765f,  2.472058f,  2.171196f,  3.385529f,  4.294995f,  3.653677f,  2.67569f,  2.956899f,  2.252736f,  1.486555f,  4.369126f,  3.505489f,  1.851819f,  4.03541f,  2.360516f,  2.936681f,  1.231981f,  1.693729f,  1.640814f,  1.984186f,  1.188148f,  1.384782f,  1.457199f,  2.069783f,  5.234804f,  1.113088f,  1.293686f,  2.017359f,  2.853041f,  1.456293f,  1.409798f,  3.594638f,  1.178108f,  1.355213f,  2.151638f,  3.382157f,  4.116253f,  2.484161f,  2.535639f,  4.248458f,  3.618502f,  1.029966f,  1.729484f,  2.63225f,  1.367122f,  1.634182f,  1.41973f,  3.522768f,  5.070103f,  0.8074f,  2.094894f,  2.316018f,  3.058936f,  3.105294f,  1.890553f,  1.435977f,  1.92512f,  1.731887f,  1.358465f,  1.965537f,  3.585413f,  1.745268f,  2.883919f,  2.578717f,  1.880818f,  5.418135f,  3.228431f,  2.010143f,  2.45912f,  4.514047f,  1.7347f,  2.281596f,  2.159699f,  1.579683f,  2.00735f,  3.706601f,  4.007991f,  2.472053f,  1.724421f,  1.889605f,  2.518133f,  2.84035f,  1.751531f,  3.606602f,  1.607786f,  1.945737f,  3.236766f,  3.387308f,  2.105602f,  3.340031f,  2.625562f,  2.789621f,  2.799774f,  3.478442f,  2.364704f,  1.584847f,  1.805852f,  3.190073f,  3.307748f,  2.619448f,  1.774906f,  1.691434f,  2.205351f,  1.445763f,  3.294953f,  2.389077f,  1.656286f,  2.852394f,  1.903534f,  3.312433f,  1.733694f,  1.357239f,  2.926443f,  1.026072f,  1.691016f,  1.32349f,  3.748037f,  2.242608f,  1.216382f,  4.056121f,  1.76495f,  2.091812f,  5.378484f,  3.318344f,  2.242834f,  2.098573f,  1.514949f,  1.406781f,  1.706496f,  1.566573f,  2.180213f,  1.393867f,  1.293929f,  1.672091f,  2.341493f,  2.906132f,  1.725755f,  2.118609f,  2.032982f,  2.375728f,  3.75372f,  3.382644f,  1.307015f,  3.438929f,  2.358929f,  3.31988f,  1.201525f,  1.061207f,  1.720163f,  2.77478f,  2.012914f,  1.528621f,  1.489572f,  2.014648f,  2.506553f,  1.165533f,  2.255969f,  4.443931f,  3.119305f,  3.894559f,  3.272496f,  1.844927f,  2.502512f,  4.793592f,  3.477832f,  1.843952f,  2.722272f,  2.677128f,  2.094914f,  1.652658f,  2.128754f,  2.1105f,  1.989956f,  1.914f,  3.450271f,  2.724176f,  1.723113f,  2.339737f,  2.518752f,  1.944501f,  1.8093f,  3.313133f,  3.089303f,  2.396977f,  1.488191f,  1.805118f,  1.384258f,  1.817271f,  2.427106f,  2.091595f,  3.133079f,  1.957668f,  1.201252f,  2.320236f,  0.873002f,  2.406543f,  2.998699f,  1.431357f,  2.180003f,  2.551728f,  1.555919f,  1.308252f,  3.082367f,  2.000819f,  1.35681f,  2.881864f,  3.045615f,  1.401307f,  2.281813f,  3.311975f,  1.879752f,  2.674045f,  1.702625f,  4.806692f,  2.6633f,  2.539375f,  3.608847f,  1.638065f,  1.622052f,  5.144179f,  2.478982f,  1.113508f,  1.707145f,  3.008972f,  4.153109f,  1.647314f,  3.584877f,  3.186455f,  1.391287f,  2.98846f,  3.420756f,  1.555315f,  2.647372f,  3.522963f,  2.073882f,  3.598407f,  4.823432f,  2.543281f,  2.09985f,  1.507753f,  1.559111f,  2.447589f,  2.692172f,  1.905802f,  1.359945f,  1.360406f,  3.07358f,  4.138884f,  2.867529f,  3.858283f,  4.39673f,  1.756164f,  1.731174f,  2.716537f,  2.230661f,  1.982752f,  4.081751f,  1.317913f,  2.293607f,  1.248808f,  1.813977f,  2.324964f,  3.797154f,  1.243477f,  2.622861f,  2.891318f,  2.098941f,  1.918142f,  1.658672f,  2.607744f,  1.90939f,  0.969651f,  2.750912f,  1.706031f,  4.301949f,  2.172422f,  2.424465f,  2.404524f,  2.221251f,  1.090719f,  1.762291f,  1.757226f,  3.492945f,  2.582739f,  2.781026f,  2.510998f,  2.728519f,  3.351631f,  2.970628f,  2.506746f,  1.350114f,  2.257208f,  4.953198f,  2.843351f,  2.876023f,  1.409066f,  1.495973f,  3.256744f,  2.028203f,  3.405456f,  2.362312f,  2.931191f,  2.785503f,  2.203989f,  3.015947f,  1.164988f,  1.374239f,  1.353737f,  2.73377f,  3.07746f,  2.161323f,  3.363472f,  2.841914f,  1.538665f,  2.62724f,  3.174611f,  2.181137f,  1.729041f,  1.742964f,  1.278192f,  2.129161f,  3.314118f,  2.170573f,  2.295406f,  2.257581f,  1.831594f,  2.95217f,  4.619727f,  3.952237f,  0.919504f,  1.941558f,  3.235512f,  2.378852f,  2.947361f,  3.227413f,  1.600512f,  2.646622f,  2.170172f,  2.251007f,  1.337266f,  0.876951f,  1.296814f, };
const std::vector<float> fire9_expand3x3_calib = {
    1.007729f,  2.401496f,  2.210445f,  2.804331f,  0.600268f,  2.477034f,  2.388336f,  5.995232f,  1.543836f,  0.877708f,  0.0f,  8.896174f,  0.0f,  7.731974f,  1.388156f,  2.891964f,  3.589132f,  2.290087f,  0.982144f,  1.13316f,  0.591399f,  1.471249f,  0.973516f,  0.623325f,  6.779046f,  2.12515f,  6.558528f,  2.584479f,  0.0f,  1.307016f,  3.682867f,  3.920721f,  1.991873f,  0.0f,  1.00933f,  10.10535f,  13.11363f,  11.427646f,  2.716967f,  1.203712f,  5.662918f,  0.656575f,  1.026171f,  1.665655f,  0.0f,  1.926096f,  3.823861f,  2.485892f,  13.335013f,  3.328816f,  3.295055f,  1.103446f,  1.706565f,  1.977568f,  1.817664f,  1.269416f,  1.632326f,  13.455157f,  0.703254f,  3.818068f,  6.0099f,  1.716945f,  1.012001f,  1.058536f,  7.705095f,  0.822635f,  0.90737f,  0.0f,  1.844892f,  1.350142f,  5.740891f,  1.289277f,  1.945925f,  2.318288f,  0.580869f,  1.450981f,  1.455714f,  1.379477f,  1.408449f,  1.92198f,  0.451988f,  3.249569f,  7.528871f,  1.322958f,  2.533322f,  0.0f,  1.709031f,  0.922121f,  2.274461f,  0.0f,  5.21f,  0.0f,  1.463555f,  0.928546f,  0.566443f,  0.0f,  1.179519f,  0.637131f,  6.989736f,  1.813508f,  4.079745f,  0.997502f,  0.76973f,  58.69738f,  2.738403f,  2.187487f,  2.27493f,  1.098093f,  0.698766f,  0.770299f,  1.46814f,  1.5039f,  0.842891f,  0.374346f,  4.017017f,  4.586841f,  1.065857f,  0.0f,  1.092765f,  2.966375f,  1.404925f,  5.016055f,  1.194934f,  1.73824f,  8.225762f,  0.349001f,  2.786469f,  1.177551f,  0.952602f,  0.629832f,  2.317937f,  1.661458f,  0.958722f,  1.063937f,  4.762744f,  0.0f,  2.526262f,  1.212341f,  1.03071f,  0.577761f,  2.339379f,  1.492129f,  1.04147f,  3.54161f,  0.463795f,  0.601152f,  1.794231f,  0.4616f,  2.561548f,  84.413426f,  0.44882f,  0.91993f,  6.960315f,  0.936986f,  3.74491f,  0.354527f,  1.277685f,  0.0f,  1.084626f,  0.0f,  0.0f,  0.900863f,  0.988081f,  1.058545f,  0.987497f,  2.625214f,  1.071676f,  1.428207f,  2.7997f,  1.203643f,  8.308419f,  0.778368f,  0.868352f,  2.998288f,  1.608344f,  1.626441f,  0.472854f,  2.759934f,  1.060747f,  3.992819f,  3.849266f,  0.34631f,  2.325173f,  2.74959f,  0.7573f,  2.379543f,  2.119585f,  1.038388f,  0.237891f,  1.609455f,  0.0f,  3.422378f,  6.041951f,  1.431407f,  0.0f,  2.833493f,  10.829247f,  2.086804f,  2.041407f,  3.291878f,  8.709009f,  1.192925f,  0.85192f,  1.329407f,  1.479309f,  0.736454f,  2.36452f,  6.48022f,  2.118503f,  2.700203f,  7.382004f,  2.574728f,  1.316668f,  0.560848f,  2.698167f,  2.50727f,  5.32169f,  1.699319f,  1.247422f,  0.0f,  1.793251f,  2.931827f,  1.108725f,  0.575603f,  0.0f,  1.541442f,  2.896528f,  0.937975f,  4.507494f,  1.247826f,  1.27767f,  0.88818f,  0.850369f,  1.326002f,  0.620141f,  4.779899f,  1.106715f,  15.19575f,  0.756155f,  2.571235f,  2.025867f,  0.0f,  130.233569f,  1.148085f,  1.467351f,  0.715199f,  1.164304f,  4.975807f,  7.995769f,  0.510009f,  1.120572f,  2.292464f,  1.125158f,  1.118746f,  0.83456f,  1.730606f, };
const std::vector<float> fire9_expand1x1_calib = {
    0.941047f,  1.247213f,  7.632166f,  0.690649f,  0.0f,  4.1728f,  0.0f,  5.565806f,  11.186766f,  4.192997f,  4.238858f,  0.0f,  3.871361f,  3.401124f,  7.463169f,  3.245061f,  9.667499f,  0.850095f,  4.767464f,  1.940534f,  3.350446f,  10.052479f,  1.183322f,  0.0f,  0.0f,  8.977803f,  6.190773f,  8.924556f,  5.315542f,  6.153608f,  0.0f,  0.645932f,  4.752051f,  2.64352f,  1.841145f,  13.922065f,  0.985573f,  1.601812f,  4.592348f,  6.056589f,  1.536364f,  9.140044f,  1.985377f,  2.193213f,  1.580711f,  0.0f,  0.819841f,  0.0f,  1.989585f,  1.137371f,  0.656534f,  1.993533f,  1.751937f,  26.332268f,  2.31825f,  2.141924f,  1.390842f,  0.816852f,  1.839231f,  1.537988f,  8.023806f,  1.821483f,  6.251631f,  0.0f,  3.206925f,  0.0f,  3.448117f,  2.259827f,  9.469062f,  13.201087f,  0.0f,  4.176381f,  1.089736f,  2.8137f,  22.593362f,  39.005753f,  0.800005f,  4.37236f,  2.115743f,  2.141526f,  1.502676f,  0.0f,  0.0f,  0.0f,  0.727969f,  2.120491f,  1.973781f,  0.0f,  0.0f,  8.507731f,  2.218232f,  1.005845f,  1.177955f,  4.50871f,  0.811362f,  2.168657f,  1.29958f,  2.352854f,  1.124073f,  3.902601f,  0.0f,  2.953646f,  1.990524f,  14.030452f,  10.048661f,  0.81266f,  3.401515f,  2.017359f,  0.745467f,  0.0f,  1.137983f,  9.577316f,  0.0f,  1.704261f,  2.072634f,  1.315367f,  1.270193f,  0.0f,  1.353946f,  0.0f,  2.909268f,  4.298149f,  0.0f,  2.100173f,  1.508613f,  2.162692f,  5.874272f,  1.547427f,  0.750015f,  5.971104f,  0.0f,  0.98455f,  9.635739f,  2.327917f,  2.369478f,  1.362393f,  0.0f,  6.013941f,  1.435479f,  7.599921f,  2.364603f,  2.091416f,  5.812357f,  2.839321f,  3.940281f,  0.0f,  3.543734f,  0.0f,  3.449606f,  2.24889f,  25.617751f,  0.785221f,  5.20622f,  1.318586f,  0.0f,  1.539194f,  1.501388f,  0.89707f,  1.132008f,  78.75969f,  0.886704f,  1.538784f,  5.938353f,  0.0f,  6.311029f,  2.305126f,  0.971356f,  1.577048f,  0.0f,  2.901411f,  4.433367f,  1.407115f,  3.798063f,  10.835345f,  0.781899f,  2.003158f,  1.894612f,  13.395791f,  0.0f,  2.281481f,  6.860007f,  1.575589f,  1.544952f,  2.631355f,  5.834976f,  22.423504f,  2.182416f,  0.0f,  0.0f,  4.25311f,  27.984972f,  5.201401f,  0.842924f,  1.692893f,  2.363622f,  0.0f,  5.884588f,  5.310874f,  1.97884f,  3.583724f,  0.0f,  2.387986f,  2.991452f,  5.28616f,  1.980226f,  6.92721f,  2.986401f,  0.0f,  82.099153f,  8.498394f,  0.0f,  4.935105f,  0.0f,  0.0f,  1.912092f,  3.876998f,  1.592874f,  8.128f,  3.203729f,  4.848753f,  5.378439f,  0.83612f,  1.779005f,  1.898685f,  0.0f,  1.037989f,  0.0f,  3.897547f,  2.458534f,  9.395854f,  63.377681f,  13.727044f,  0.581244f,  4.597002f,  0.982121f,  5.058753f,  0.726852f,  36.505687f,  10.944408f,  1.620851f,  0.594146f,  2.545361f,  0.0f,  9.008626f,  1.144093f,  1.412942f,  11.164933f,  0.0f,  0.0f,  1.107825f,  0.947867f,  0.869053f,  1.256493f,  1.823775f,  0.801115f,  1.46295f, };

template<typename T>
void quantize_weights(cldnn::memory& weights, cldnn::memory& w_qf)
{
    auto batch_pitch = weights.get_layout().get_pitches().batch[0];
    auto ptr = weights.pointer<T>();
    auto wqf_ptr = w_qf.pointer<float>();
    T max = (T) 0.0f;
    for (int ofm = 0; ofm < weights.get_layout().size.batch[0]; ofm++)
    {
        max = (T) 0.0f;
        for (int w = 0; w < batch_pitch; w++)
            if (max < abs(ptr[ofm* batch_pitch + w]))
                max = abs(ptr[ofm* batch_pitch + w]);

        if (max == (T)0)
            max = (T)1; // do not quantize

        for (int w = 0; w < batch_pitch; w++)
            ptr[ofm* batch_pitch + w] = (T)round((float)ptr[ofm* batch_pitch + w] * 127.0f / (float)max);
        wqf_ptr[ofm] = max / 127.0f;
    }
}
template<typename T>
void calibrate(const cldnn::memory& output, cldnn::memory& calibrations)
{
    auto feature_pitch = output.get_layout().get_pitches().feature[0];
    auto ptr = output.pointer<T>();
    auto calibrations_ptr = calibrations.pointer<float>();
    T max = (T) 0.0f;
    for (int ofm = 0; ofm < output.get_layout().size.feature[0]; ofm++)
    {
        max = (T) 0.0f;
        for (int w = 0; w < feature_pitch; w++)
            if (max < abs(ptr[ofm* feature_pitch + w]))
                max = abs(ptr[ofm* feature_pitch + w]);
        calibrations_ptr[ofm] = 127.0f / max;
    }
}

template<typename T>
T max_abs(const cldnn::memory& mem)
{
    T max = (T)0;
    auto ptr = mem.pointer<T>();
    for (auto& a : ptr)
        if (max < abs(a))
            max = abs(a);
    return max;
}

template<typename T>
void apply_calibration_on_weights(cldnn::memory& weights,const std::vector<float>& qf)
{
    auto batch_pitch = weights.get_layout().get_pitches().batch[0];
    auto ptr = weights.pointer<T>();
    tensor w_size = weights.get_layout().size;
    int index = 0;
    for (int ofm = 0; ofm < w_size.batch[0]; ofm++)
        for (int ifm = 0; ifm < w_size.feature[0]; ifm++)
            for (int xy = 0; xy < w_size.spatial[0] * w_size.spatial[1]; xy++)
            {
                if (qf[ifm] != 0.0f)
                    ptr[index] = ptr[index] / qf[ifm];
                else
                    ptr[index] = (T)0;
                index++;
            }
}

cldnn::memory create_int8_weights(engine engine, cldnn::memory& in_weights)
{
    auto layout = in_weights.get_layout();
    auto out_weights = memory::allocate(engine, { data_types::i8, layout.format, layout.size });
    auto in = in_weights.pointer<float>();
    auto out = out_weights.pointer<char>();
    int indx = 0;
    for (auto& a : in)
        out[indx++] = (char)a;
    return out_weights;
}


void add_calibration(
    const engine& engine,
    const std::string& weights_dir,
    const std::string& name,
    const std::vector<float>& in_calib,
    const std::vector<float>& out_calib,
    topology& topology)
{

    auto weights = file::create({ engine, join_path(weights_dir, name + "_weights.nnd") });
    auto& w_mem = weights.mem;
    apply_calibration_on_weights<float>(w_mem, in_calib);
    auto w_qf = memory::allocate(engine, { data_types::f32, format::bfyx,{ 1, w_mem.get_layout().size.batch[0], 1, 1 } });
    auto o_qf = memory::allocate(engine, { data_types::f32, format::bfyx,{ 1, (int32_t)out_calib.size(), 1, 1 } });
    set_values(o_qf, out_calib);
    quantize_weights<float>(w_mem, w_qf);
    auto w_int = create_int8_weights(engine, w_mem);
    auto weigths_int = data(name + "_weights_int", w_int);
    auto weights_qf = data(name + "_w_qf", w_qf);
    auto output_qf = data(name + "_o_qf", o_qf);

    topology.add(weigths_int, weights_qf, output_qf);
}

topology build_squeezenet_quant(const std::string& weights_dir, const cldnn::engine& engine, cldnn::layout& input_layout, int32_t batch_size)
{
    cldnn::topology topology;
    // [227x227x3xB] convolution->relu->pooling->lrn [1000xB]
    input_layout.size = { batch_size, 3, 227, 227 };
    auto input = cldnn::input_layout("input", input_layout);

    //auto reorder_mean = { (float)104.0069879317889, (float)116.66876761696767, (float)122.6789143406786 };
    auto reordered_input = reorder(
        "reorder",
        input,
        { input_layout.data_type, input_layout.format, input_layout.size },
        std::vector<float>{ (float)104.0069879317889, (float)116.66876761696767, (float)122.6789143406786 });

    auto conv1_weights = file::create({ engine, join_path(weights_dir, "conv1_weights.nnd")});
    auto conv1_bias = file::create({ engine, join_path(weights_dir, "conv1_bias.nnd")});
    auto conv1 = convolution(
        "conv1",
        reordered_input,
        { conv1_weights },
        { conv1_bias },
        { 1,1,2,2 },
        { 0,0,0,0 },
        { 1,1,1,1 },
        true);

    auto pool1 = pooling(
        "pool1",
        conv1,
        pooling_mode::max,
        { 1,1,3,3 }, // kernel
        { 1,1,2,2 }); // strd


    auto fire2_squeeze1x1_weights = file::create({ engine, join_path(weights_dir, "fire2_squeeze1x1_weights.nnd")});
    auto fire2_squeeze1x1_bias = file::create({ engine, join_path(weights_dir, "fire2_squeeze1x1_bias.nnd")});
    auto fire2_squeeze1x1 = convolution(
        "fire2_squeeze1x1",
        pool1,
        { fire2_squeeze1x1_weights },
        { fire2_squeeze1x1_bias },
        { 1,1,1,1 },
        { 0,0,0,0 },
        { 1,1,1,1 },
        true);

    auto fire2_expand1x1_weights = file::create({ engine, join_path(weights_dir, "fire2_expand1x1_weights.nnd")});
    auto fire2_expand1x1_bias = file::create({ engine, join_path(weights_dir, "fire2_expand1x1_bias.nnd")});
    auto fire2_expand1x1 = convolution(
        "fire2_expand1x1",
        fire2_squeeze1x1,
        { fire2_expand1x1_weights },
        { fire2_expand1x1_bias },
        { 1,1,1,1 },
        { 0,0,0,0 },
        { 1,1,1,1 },
        true);

    auto fire2_expand3x3_weights = file::create({ engine, join_path(weights_dir, "fire2_expand3x3_weights.nnd")});
    auto fire2_expand3x3_bias = file::create({ engine, join_path(weights_dir, "fire2_expand3x3_bias.nnd")});
    auto fire2_expand3x3 = convolution(
        "fire2_expand3x3",
        fire2_squeeze1x1,
        { fire2_expand3x3_weights },
        { fire2_expand3x3_bias },
        { 1,1,1,1 },
        { 0, 0, -1,-1 },
        { 1,1,1,1 },
        true);


    auto fire2_concat = concatenation(   
        "fire2_concat",
        {
            fire2_expand1x1,
            fire2_expand3x3
        },
        concatenation::along_f
    );


    auto fire3_squeeze1x1_weights = file::create({ engine, join_path(weights_dir, "fire3_squeeze1x1_weights.nnd")});
    auto fire3_squeeze1x1_bias = file::create({ engine, join_path(weights_dir, "fire3_squeeze1x1_bias.nnd")});
    auto fire3_squeeze1x1 = convolution(
        "fire3_squeeze1x1",
        fire2_concat,
        { fire3_squeeze1x1_weights },
        { fire3_squeeze1x1_bias },
        { 1,1,1,1 },
        { 0,0,0,0 },
        { 1,1,1,1 },
        true);

    auto fire3_expand1x1_weights = file::create({ engine, join_path(weights_dir, "fire3_expand1x1_weights.nnd")});
    auto fire3_expand1x1_bias = file::create({ engine, join_path(weights_dir, "fire3_expand1x1_bias.nnd")});
    auto fire3_expand1x1 = convolution(
        "fire3_expand1x1",
        fire3_squeeze1x1,
        { fire3_expand1x1_weights },
        { fire3_expand1x1_bias },
        { 1,1,1,1 },
        { 0,0,0,0 },
        { 1,1,1,1 },
        true);

    auto fire3_expand3x3_weights = file::create({ engine, join_path(weights_dir, "fire3_expand3x3_weights.nnd")});
    auto fire3_expand3x3_bias = file::create({ engine, join_path(weights_dir, "fire3_expand3x3_bias.nnd")});
    auto fire3_expand3x3 = convolution(
        "fire3_expand3x3",
        fire3_squeeze1x1,
        { fire3_expand3x3_weights },
        { fire3_expand3x3_bias },
        { 1,1,1,1 },
        { 0, 0, -1,-1 },
        { 1,1,1,1 },
        true);

    auto fire3_concat = concatenation(
        "fire3_concat",
        {
            fire3_expand1x1,
            fire3_expand3x3
        },
        concatenation::along_f
    );

    auto pool3 = pooling(
        "pool3",
        fire3_concat,
        pooling_mode::max,
        { 1,1,3,3 }, // kernel
        { 1,1,2,2 }); // strd

    auto fire4_squeeze1x1_weights = file::create({ engine, join_path(weights_dir, "fire4_squeeze1x1_weights.nnd")});
    auto fire4_squeeze1x1_bias = file::create({ engine, join_path(weights_dir, "fire4_squeeze1x1_bias.nnd")});
    auto fire4_squeeze1x1 = convolution(
        "fire4_squeeze1x1",
        pool3,
        { fire4_squeeze1x1_weights },
        { fire4_squeeze1x1_bias },
        { 1,1,1,1 },
        { 0,0,0,0 },
        { 1,1,1,1 },
        true);

    auto fire4_expand1x1_weights = file::create({ engine, join_path(weights_dir, "fire4_expand1x1_weights.nnd")});
    auto fire4_expand1x1_bias = file::create({ engine, join_path(weights_dir, "fire4_expand1x1_bias.nnd")});
    auto fire4_expand1x1 = convolution(
        "fire4_expand1x1",
        fire4_squeeze1x1,
        { fire4_expand1x1_weights },
        { fire4_expand1x1_bias },
        { 1,1,1,1 },
        { 0,0,0,0 },
        { 1,1,1,1 },
        true);

    auto fire4_expand3x3_weights = file::create({ engine, join_path(weights_dir, "fire4_expand3x3_weights.nnd")});
    auto fire4_expand3x3_bias = file::create({ engine, join_path(weights_dir, "fire4_expand3x3_bias.nnd")});
    auto fire4_expand3x3 = convolution(
        "fire4_expand3x3",
        fire4_squeeze1x1,
        { fire4_expand3x3_weights },
        { fire4_expand3x3_bias },
        { 1,1,1,1 },
        { 0, 0, -1,-1 },
        { 1,1,1,1 },
        true);

    auto fire4_concat = concatenation(
        "fire4_concat",
        {
            fire4_expand1x1,
            fire4_expand3x3
        },
        concatenation::along_f
    );

    auto fire5_squeeze1x1_weights = file::create({ engine, join_path(weights_dir, "fire5_squeeze1x1_weights.nnd")});
    auto fire5_squeeze1x1_bias = file::create({ engine, join_path(weights_dir, "fire5_squeeze1x1_bias.nnd")});
    auto fire5_squeeze1x1 = convolution(
        "fire5_squeeze1x1",
        fire4_concat,
        { fire5_squeeze1x1_weights },
        { fire5_squeeze1x1_bias },
        { 1,1,1,1 },
        { 0,0,0,0 },
        { 1,1,1,1 },
        true);

    auto fire5_expand1x1_weights = file::create({ engine, join_path(weights_dir, "fire5_expand1x1_weights.nnd")});
    auto fire5_expand1x1_bias = file::create({ engine, join_path(weights_dir, "fire5_expand1x1_bias.nnd")});
    auto fire5_expand1x1 = convolution(
        "fire5_expand1x1",
        fire5_squeeze1x1,
        { fire5_expand1x1_weights },
        { fire5_expand1x1_bias },
        { 1,1,1,1 },
        { 0,0,0,0 },
        { 1,1,1,1 },
        true);

    auto fire5_expand3x3_weights = file::create({ engine, join_path(weights_dir, "fire5_expand3x3_weights.nnd")});
    auto fire5_expand3x3_bias = file::create({ engine, join_path(weights_dir, "fire5_expand3x3_bias.nnd")});
    auto fire5_expand3x3 = convolution(
        "fire5_expand3x3",
        fire5_squeeze1x1,
        { fire5_expand3x3_weights },
        { fire5_expand3x3_bias },
        { 1,1,1,1 },
        { 0, 0, -1,-1 },
        { 1,1,1,1 },
        true);

    auto fire5_concat = concatenation(
        "fire5_concat",
        {
            fire5_expand1x1,
            fire5_expand3x3
        },
        concatenation::along_f
    );

    auto pool5 = pooling(
        "pool5",
        fire5_concat,
        pooling_mode::max,
        { 1,1,3,3 }, // kernel
        { 1,1,2,2 }); // strd

    auto fire6_squeeze1x1_weights = file::create({ engine, join_path(weights_dir, "fire6_squeeze1x1_weights.nnd")});
    auto fire6_squeeze1x1_bias = file::create({ engine, join_path(weights_dir, "fire6_squeeze1x1_bias.nnd")});
    auto fire6_squeeze1x1 = convolution(
        "fire6_squeeze1x1",
        pool5,
        { fire6_squeeze1x1_weights },
        { fire6_squeeze1x1_bias },
        { 1,1,1,1 },
        { 0,0,0,0 },
        { 1,1,1,1 },
        true);

    auto fire6_expand1x1_weights = file::create({ engine, join_path(weights_dir, "fire6_expand1x1_weights.nnd")});
    auto fire6_expand1x1_bias = file::create({ engine, join_path(weights_dir, "fire6_expand1x1_bias.nnd")});
    auto fire6_expand1x1 = convolution(
        "fire6_expand1x1",
        fire6_squeeze1x1,
        { fire6_expand1x1_weights },
        { fire6_expand1x1_bias },
        { 1,1,1,1 },
        { 0,0,0,0 },
        { 1,1,1,1 },
        true);

    auto fire6_expand3x3_weights = file::create({ engine, join_path(weights_dir, "fire6_expand3x3_weights.nnd")});
    auto fire6_expand3x3_bias = file::create({ engine, join_path(weights_dir, "fire6_expand3x3_bias.nnd")});
    auto fire6_expand3x3 = convolution(
        "fire6_expand3x3",
        fire6_squeeze1x1,
        { fire6_expand3x3_weights },
        { fire6_expand3x3_bias },
        { 1,1,1,1 },
        { 0, 0, -1,-1 },
        { 1,1,1,1 },
        true);

    auto fire6_concat = concatenation( 
        "fire6_concat",
        {
            fire6_expand1x1,
            fire6_expand3x3
        },
        concatenation::along_f
    );

    auto fire7_squeeze1x1_weights = file::create({ engine, join_path(weights_dir, "fire7_squeeze1x1_weights.nnd")});
    auto fire7_squeeze1x1_bias = file::create({ engine, join_path(weights_dir, "fire7_squeeze1x1_bias.nnd")});
    auto fire7_squeeze1x1 = convolution(
        "fire7_squeeze1x1",
        fire6_concat,
        { fire7_squeeze1x1_weights },
        { fire7_squeeze1x1_bias },
        { 1,1,1,1 },
        { 0,0,0,0 },
        { 1,1,1,1 },
        true);

    auto fire7_expand1x1_weights = file::create({ engine, join_path(weights_dir, "fire7_expand1x1_weights.nnd")});
    auto fire7_expand1x1_bias = file::create({ engine, join_path(weights_dir, "fire7_expand1x1_bias.nnd")});
    auto fire7_expand1x1 = convolution(
        "fire7_expand1x1",
        fire7_squeeze1x1,
        { fire7_expand1x1_weights },
        { fire7_expand1x1_bias },
        { 1,1,1,1 },
        { 0,0,0,0 },
        { 1,1,1,1 },
        true);

    auto fire7_expand3x3_weights = file::create({ engine, join_path(weights_dir, "fire7_expand3x3_weights.nnd")});
    auto fire7_expand3x3_bias = file::create({ engine, join_path(weights_dir, "fire7_expand3x3_bias.nnd")});
    auto fire7_expand3x3 = convolution(
        "fire7_expand3x3",
        fire7_squeeze1x1,
        { fire7_expand3x3_weights },
        { fire7_expand3x3_bias },
        { 1,1,1,1 },
        { 0, 0, -1,-1 },
        { 1,1,1,1 },
        true);

    auto fire7_concat = concatenation(
        "fire7_concat",
        {
            fire7_expand1x1,
            fire7_expand3x3
        },
        concatenation::along_f
    );

    auto fire8_squeeze1x1_weights = file::create({ engine, join_path(weights_dir, "fire8_squeeze1x1_weights.nnd")});
    auto fire8_squeeze1x1_bias = file::create({ engine, join_path(weights_dir, "fire8_squeeze1x1_bias.nnd")});
    auto fire8_squeeze1x1 = convolution(
        "fire8_squeeze1x1",
        fire7_concat,
        { fire8_squeeze1x1_weights },
        { fire8_squeeze1x1_bias },
        { 1,1,1,1 },
        { 0,0,0,0 },
        { 1,1,1,1 },
        true);

    auto fire8_expand1x1_weights = file::create({ engine, join_path(weights_dir, "fire8_expand1x1_weights.nnd")});
    auto fire8_expand1x1_bias = file::create({ engine, join_path(weights_dir, "fire8_expand1x1_bias.nnd")});
    auto fire8_expand1x1 = convolution(
        "fire8_expand1x1",
        fire8_squeeze1x1,
        { fire8_expand1x1_weights },
        { fire8_expand1x1_bias },
        { 1,1,1,1 },
        { 0,0,0,0 },
        { 1,1,1,1 },
        true);

    auto fire8_expand3x3_weights = file::create({ engine, join_path(weights_dir, "fire8_expand3x3_weights.nnd")});
    auto fire8_expand3x3_bias = file::create({ engine, join_path(weights_dir, "fire8_expand3x3_bias.nnd")});
    auto fire8_expand3x3 = convolution(
        "fire8_expand3x3",
        fire8_squeeze1x1,
        { fire8_expand3x3_weights },
        { fire8_expand3x3_bias },
        { 1,1,1,1 },
        { 0, 0, -1,-1 },
        { 1,1,1,1 },
        true);

    auto fire8_concat = concatenation(
        "fire8_concat",
        {
            fire8_expand1x1,
            fire8_expand3x3
        },
        concatenation::along_f
    );

    add_calibration(engine, weights_dir, "fire9_squeeze1x1", fire8_concat_calib, fire9_squeeze1x1_calib, topology);
    auto fire9_squeeze1x1_bias = file::create({ engine, join_path(weights_dir, "fire9_squeeze1x1_bias.nnd")});
    auto fire9_squeeze1x1_calibrator = reorder("fire9_squeeze1x1_calib", "fire8_concat",
        format::bfyx, data_types::i8, fire8_concat_calib, cldnn_reorder_mean_mode::mean_mul);
    auto fire9_squeeze1x1 = convolution(
        "fire9_squeeze1x1",
        fire9_squeeze1x1_calibrator,
        { "fire9_squeeze1x1_weights_int" },
        { fire9_squeeze1x1_bias },
        { "fire9_squeeze1x1_w_qf" },
        { "fire9_squeeze1x1_o_qf" },
        1.0f, // do not scale input
        { 1,1,1,1 },
        { 0,0,0,0 },
        { 1,1,1,1 },
        true);

    add_calibration(engine, weights_dir, "fire9_expand1x1", fire9_squeeze1x1_calib, fire9_expand1x1_calib, topology);
    auto fire9_expand1x1_bias = file::create({ engine, join_path(weights_dir, "fire9_expand1x1_bias.nnd")});

    auto fire9_expand1x1 = convolution(
        "fire9_expand1x1",
        fire9_squeeze1x1,
        { "fire9_expand1x1_weights_int" },
        { fire9_expand1x1_bias },
        { "fire9_expand1x1_w_qf" },
        { "fire9_expand1x1_o_qf" },
        1.0f, // do not scale input
        { 1,1,1,1 },
        { 0,0,0,0 },
        { 1,1,1,1 },
        true);

    add_calibration(engine, weights_dir, "fire9_expand3x3", fire9_squeeze1x1_calib, fire9_expand3x3_calib, topology);
    auto fire9_expand3x3_bias = file::create({ engine, join_path(weights_dir, "fire9_expand3x3_bias.nnd")});

    auto fire9_expand3x3 = convolution(
        "fire9_expand3x3",
        fire9_squeeze1x1,
        { "fire9_expand3x3_weights_int" },
        { fire9_expand3x3_bias },
        { "fire9_expand3x3_w_qf" },
        { "fire9_expand3x3_o_qf" },
        1.0f, // do not scale input
        { 1,1,1,1 },
        { 0, 0, -1,-1 },
        { 1,1,1,1 },
        true);

    auto fire9_concat = concatenation(
        "fire9_concat",
        {
            fire9_expand1x1,
            fire9_expand3x3
        },
        concatenation::along_f
    );

    auto conv10_bias = file::create({ engine, join_path(weights_dir, "conv10_bias.nnd") });
    add_calibration(engine, weights_dir, "conv10", fire9_concat_calib, conv10_calib, topology);

    auto conv10 = convolution(
        "conv10",
        fire9_concat,
        { "conv10_weights_int" },
        { conv10_bias },
        { "conv10_w_qf" },
        { "conv10_o_qf" },
        1.0f, // do not scale input
        { 1,1,1,1 },
        { 0,0,0,0 },
        { 1,1,1,1 },
        true);
    auto conv10_decalibrator = reorder("conv10_decalib", "conv10",
        format::bfyx, data_types::f32, conv10_calib, cldnn_reorder_mean_mode::mean_div);

    auto pool10 = pooling(
        "pool10",
        conv10_decalibrator,
        pooling_mode::average,
        { 1,1,14,14 }, // kernel
        { 1,1,1,1 }); // strd

    auto softmax = cldnn::softmax(
        "output",
        pool10);

    topology.add(
        input,
        reordered_input,
        conv1, conv1_weights, conv1_bias,
        pool1,
        fire2_squeeze1x1, fire2_squeeze1x1_weights, fire2_squeeze1x1_bias
    );
    
    topology.add(fire2_expand1x1, fire2_expand1x1_weights, fire2_expand1x1_bias);
    topology.add(fire2_expand3x3, fire2_expand3x3_weights, fire2_expand3x3_bias);
        
    topology.add(
        fire2_concat);
    topology.add(
        fire3_squeeze1x1, fire3_squeeze1x1_weights, fire3_squeeze1x1_bias,
        fire3_expand1x1, fire3_expand1x1_weights, fire3_expand1x1_bias,
        fire3_expand3x3, fire3_expand3x3_weights, fire3_expand3x3_bias,
        fire3_concat,
        pool3);
    topology.add(
        fire4_squeeze1x1, fire4_squeeze1x1_weights, fire4_squeeze1x1_bias,
        fire4_expand1x1, fire4_expand1x1_weights, fire4_expand1x1_bias,
        fire4_expand3x3, fire4_expand3x3_weights, fire4_expand3x3_bias,
        fire4_concat);
    topology.add(
        fire5_squeeze1x1, fire5_squeeze1x1_weights, fire5_squeeze1x1_bias,
        fire5_expand1x1, fire5_expand1x1_weights, fire5_expand1x1_bias,
        fire5_expand3x3, fire5_expand3x3_weights, fire5_expand3x3_bias,
        fire5_concat,
        pool5);
    topology.add(
        fire6_squeeze1x1, fire6_squeeze1x1_weights, fire6_squeeze1x1_bias,
        fire6_expand1x1, fire6_expand1x1_weights, fire6_expand1x1_bias,
        fire6_expand3x3, fire6_expand3x3_weights, fire6_expand3x3_bias,
        fire6_concat);
    topology.add(
        fire7_squeeze1x1, fire7_squeeze1x1_weights, fire7_squeeze1x1_bias,
        fire7_expand1x1, fire7_expand1x1_weights, fire7_expand1x1_bias,
        fire7_expand3x3, fire7_expand3x3_weights, fire7_expand3x3_bias,
        fire7_concat);
    topology.add(
        fire8_squeeze1x1, fire8_squeeze1x1_weights, fire8_squeeze1x1_bias,
        fire8_expand1x1, fire8_expand1x1_weights, fire8_expand1x1_bias,
        fire8_expand3x3, fire8_expand3x3_weights, fire8_expand3x3_bias,
        fire8_concat);
    topology.add(
        fire9_squeeze1x1, fire9_squeeze1x1_calibrator, fire9_squeeze1x1_bias,
        fire9_expand1x1,  fire9_expand1x1_bias,
        fire9_expand3x3,  fire9_expand3x3_bias,
        fire9_concat);
    topology.add(
        conv10, conv10_bias,
        pool10,
        softmax);
    topology.add(
        /*conv10_calibrator,*/  conv10_decalibrator
        /*fire9_expand3x3_calibrator, fire9_expand3x3_decalibrator,
        fire9_expand1x1_calibrator, fire9_expand1x1_decalibrator*/);
    return topology;
}
